# Meditation Builder - Main Configuration
# ==========================================

spring:
  application:
    name: meditation-builder
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:local}

# Server Configuration
server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /api

# AI Configuration metaprompt
ai:
  textMetaprompt: "You are an expert in guided meditation and mindfulness. Improve and enrich the following text so it becomes a clear, soothing, immersive guided‑meditation script, using a soft compassionate tone, short slow‑paced sentences, sensory language, simple instructions, and a natural progression (breath → body → awareness → gentle closure). Keep the original intention while enhancing clarity, calmness, and flow. Improve this content: "
  imageMetaprompt: "You are an expert in meditation and calming visual creation. Generate a peaceful, soothing image based on the following description, using soft colors and minimalistic natural elements to convey serenity: "

# OpenAI Configuration
openai:
  base-url: ${OPENAI_BASE_URL:https://api.openai.com}
  api-key: ${OPENAI_API_KEY}

  text:
    model: ${OPENAI_TEXT_MODEL:gpt-5-nano}
    temperature: ${OPENAI_TEMPERATURE:1.0}
    max-completion-tokens: ${OPENAI_MAX_TOKENS:1024}
    top-p: ${OPENAI_TOP_P:1.0}
    frequency-penalty: ${OPENAI_FREQUENCY_PENALTY:0.0}
    presence-penalty: ${OPENAI_PRESENCE_PENALTY:0.0}

  image:
    model: ${OPENAI_IMAGE_MODEL:gpt-image-1-mini} # barato para pruebas
    size: ${OPENAI_IMAGE_SIZE:1024x1024}          # 512x512, 1024x1024, 1024x1792, 1792x1024
    quality: ${OPENAI_IMAGE_QUALITY:low}          # low|medium|high (depende de modelo)
    response-format: ${OPENAI_IMAGE_RESPONSE_FORMAT:url} # url|b64_json
    n: ${OPENAI_IMAGE_N:1}

# Media Catalog Service Configuration
media-catalog:
  base-url: ${MEDIA_CATALOG_URL:http://localhost:8081}
  connect-timeout-ms: ${MEDIA_CATALOG_CONNECT_TIMEOUT:5000}
  read-timeout-ms: ${MEDIA_CATALOG_READ_TIMEOUT:10000}

# Retry Configuration
retry:
  max-attempts: ${RETRY_MAX_ATTEMPTS:3}
  initial-interval-ms: ${RETRY_INITIAL_INTERVAL:1000}
  multiplier: ${RETRY_MULTIPLIER:2.0}
  port: ${SERVER_PORT:8080}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

# Logging Configuration
logging:
  level:
    root: INFO
    com.hexagonal.meditationbuilder: INFO
    # Never log AI prompts or responses (security)
    com.hexagonal.meditationbuilder.infrastructure.out.service: WARN
