#!/usr/bin/env bash
# Script para verificar la configuraci√≥n del proyecto

set -e

GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

echo "üîç Verificando configuraci√≥n de VetConnect"
echo "=========================================="
echo ""

# Verificar Ruby
echo -n "Ruby: "
if command -v ruby &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} $(ruby -v | cut -d' ' -f1-2)"
else
    echo -e "${RED}‚úó No instalado${NC}"
fi

# Verificar Bundler
echo -n "Bundler: "
if command -v bundle &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} $(bundle -v)"
else
    echo -e "${RED}‚úó No instalado${NC}"
fi

# Verificar PostgreSQL
echo -n "PostgreSQL: "
if command -v psql &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} $(psql --version | cut -d' ' -f3)"
else
    echo -e "${RED}‚úó No instalado${NC}"
fi

# Verificar Node.js
echo -n "Node.js: "
if command -v node &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} $(node -v)"
else
    echo -e "${RED}‚ö† No instalado (opcional)${NC}"
fi

echo ""
echo "üì¶ Verificando gemas instaladas..."
if bundle check &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} Todas las gemas est√°n instaladas"
else
    echo -e "${RED}‚úó${NC} Faltan gemas. Ejecuta: bundle install"
fi

echo ""
echo "üóÑÔ∏è  Verificando base de datos..."
if bundle exec rails db:version &> /dev/null; then
    echo -e "${GREEN}‚úì${NC} Base de datos configurada"
    echo "   Versi√≥n: $(bundle exec rails db:version | grep 'Current version' | cut -d: -f2)"
else
    echo -e "${RED}‚úó${NC} Base de datos no configurada"
fi

echo ""
echo "üìÅ Verificando archivos clave..."
files=("Gemfile" "config/database.yml" "config/routes.rb" "app/models/pet.rb" "app/controllers/pets_controller.rb")
for file in "${files[@]}"; do
    echo -n "  $file: "
    if [ -f "$file" ]; then
        echo -e "${GREEN}‚úì${NC}"
    else
        echo -e "${RED}‚úó${NC}"
    fi
done

echo ""
echo "=========================================="
