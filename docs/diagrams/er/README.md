# ER Diagrams

This directory contains Entity-Relationship diagrams generated by the **ER Data Architect** agent.

## Contents

| File | Description |
|------|-------------|
| `01-er-diagram.puml` | Main ER diagram showing all entities and relationships |

## Generation

Diagrams are generated using the ER Data Architect agent which operates in two modes:

### Extraction Mode
Extracts the data model from existing code (TypeORM entities, Prisma schema, etc.)

```
@er-data-architect.md "Generate ER diagram from code"
```

### Design Mode
Designs a new data model from PRD and documentation.

```
@er-data-architect.md "Design data model from PRD"
```

## Viewing Diagrams

### Option 1: PlantUML Online Server
1. Open http://www.plantuml.com/plantuml/uml/
2. Paste the content of the `.puml` file
3. View the rendered diagram

### Option 2: VS Code Extension
1. Install the PlantUML extension
2. Open any `.puml` file
3. Press `Alt+D` to preview

### Option 3: Command Line
```bash
plantuml docs/diagrams/er/01-er-diagram.puml
```

## Notation Guide

### Entity Definition
```plantuml
TABLE(entity_name) {
  PK(id) : UUID           -- Primary Key (bold, underlined)
  UK(email) : VARCHAR     -- Unique Key (underlined)
  FK(user_id) : UUID      -- Foreign Key (italic)
  name : VARCHAR          -- Regular column
}
```

### Relationship Cardinality

| Symbol | Meaning |
|--------|---------|
| `\|\|` | Exactly one (mandatory) |
| `\|o` | Zero or one (optional) |
| `o{` | Zero or many |
| `\|{` | One or many |

### Relationship Examples
```plantuml
' One-to-Many: User creates many Trips
users ||--o{ trips : "creates"

' Many-to-Many through junction
users ||--o{ trip_participants : "participates"
trips ||--o{ trip_participants : "has"
```

## Related Documentation

- [Data Model Documentation](../../modeloER.md) - Mermaid ER diagram
- [PRD](../../PRD.md) - Product Requirements Document
- [C4 Diagrams](../c4/) - Architecture diagrams

## Agent Reference

The ER Data Architect agent is located at:
- `.cursor/agents/diagrams/er-diagrams/er-data-architect.md`

Sub-agents:
- `er-stack-detector.md` - Detects project technology stack
- `er-code-extractor.md` - Extracts entities from code
- `er-doc-analyzer.md` - Analyzes PRD and documentation
- `er-model-designer.md` - Designs data models
- `er-validation.md` - Validates and generates diagrams
